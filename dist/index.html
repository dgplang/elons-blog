<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Elon Team's Blog</title>
    <link href="https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css" rel="stylesheet" />
    <link rel="stylesheet" href="style.css">
    <style>
        /* Ensure card text is left-aligned */
        .card-container { text-align: left; }
        .card-container h2, .card-container span { text-align: left !important; }
    </style>
</head>
<body class="bg-gray-200 font-sans">
      <!-- Navigation -->
      <nav class="fixed top-0 left-0 w-full bg-[#f7f7f7] shadow-md z-50">
          <div class="container mx-auto px-5 md:px-20 py-3 flex items-center justify-between">
              <div class="logo">
                  <a href="index.html">
                      <img src="media/logo.jpeg" alt="Elon Team Blog" class="w-1/6 md:w-1/4 logo-tint">
                  </a>
              </div>
              <button id="menu" class="md:hidden text-gray-700 focus:outline-none w-6 h-6">
                  <i class='bx bx-menu block text-2xl'></i>
                  <i class='bx bx-x hidden text-2xl'></i>
              </button>
              <ul id="nav-links" class="hidden md:flex space-x-6 items-center">
                  <li><a href="index.html" class="text-[#0c4c8a] hover:text-[#1f3750] hover:border-b-2 border-[#0c4c8a]">Home</a></li>
                  <li><a href="create.html" class="text-[#0c4c8a] hover:text-[#1f3750] hover:border-b-2 border-[#0c4c8a] member">Manage Blog</a></li>
                  <li><a href="contact.html" class="text-[#0c4c8a] hover:text-[#1f3750] hover:border-b-2 border-[#0c4c8a]">Contact</a></li>
              </ul>
              <div id="myBtn" class="hidden md:flex space-x-4">
                  <a href="login.html" class="px-4 py-2 bg-[#0c4c8a] hover:bg-[#1f3750] text-white rounded-md nonuser">Login</a>
                  <a href="registration.html" class="px-4 py-2 bg-[#0c4c8a] hover:bg-[#1f3750] text-white rounded-md nonuser">Get Started</a>
                  <a href="index.html" class="px-4 py-2 bg-[#0c4c8a] hover:bg-[#1f3750] text-white rounded-md user">Logout</a>
              </div>
          </div>
          <div id="mobileMenu" class="md:hidden px-4 pb-4 hidden flex-col">
              <ul class="space-y-2">
                  <li><a href="index.html" class="text-[#0c4c8a] hover:text-[#1f3750] hover:border-b-2 border-[#0c4c8a]">Home</a></li>
                  <li><a href="manage.html" class="text-[#0c4c8a] hover:text-[#1f3750] hover:border-b-2 border-[#0c4c8a] member">Manage Blog</a></li>
                  <li><a href="contact.html" class="text-[#0c4c8a] hover:text-[#1f3750] hover:border-b-2 border-[#0c4c8a]">Contact</a></li>
              </ul>
              <div class="pt-4 space-y-2">
                  <a href="login.html" class="px-4 py-2 bg-[#0c4c8a] hover:bg-[#1f3750] text-white rounded-md nonuser">Login</a>
                  <a href="registration.html" class="px-4 py-2 bg-[#0c4c8a] hover:bg-[#1f3750] text-white rounded-md nonuser">Get Started</a>
                  <a href="index.html" class="px-4 py-2 bg-[#0c4c8a] hover:bg-[#1f3750] text-white rounded-md user">Logout</a>
              </div>
          </div>
      </nav>

      <!-- Hero Section -->
      <section class="relative min-h-screen w-full flex items-center justify-center bg-gray-900 text-white">
        <div class="absolute inset-0">
            <img src="https://images.pexels.com/photos/5011647/pexels-photo-5011647.jpeg?auto=compress&cs=tinysrgb&w=600"
                alt="Elon Team"
                class="w-full h-full object-cover">
            <div class="absolute inset-0 bg-black opacity-50"></div> <!-- Overlay -->
        </div>
        <div class="container mx-auto px-4 sm:px-8 md:px-12 flex flex-col lg:flex-row items-center z-10">
            <div class="w-full lg:w-1/2 text-center lg:text-left">
                <h2 class="text-3xl sm:text-4xl lg:text-5xl font-bold text-white mb-4 md:mb-6 leading-tight">
                    "The people who are crazy enough to think they can change the world are the ones who do."
                </h2>
                <p class="text-lg md:text-xl text-gray-300 mb-6">— Steve Jobs</p>
                <a href="#read-more"
                  class="inline-block px-6 py-3 bg-[#0c4c8a] hover:bg-[#1f3750] text-white font-medium rounded-md transition-colors duration-300">
                    Explore the Future
                </a>
            </div>
            <div class="w-full lg:w-1/2 mt-6 lg:mt-0 hidden lg:block">
                <img src="https://images.pexels.com/photos/5011647/pexels-photo-5011647.jpeg?auto=compress&cs=tinysrgb&w=600"
                    alt="Elon Team"
                    class="w-full max-h-[60vh] object-cover rounded-lg shadow-md">
            </div>
        </div>
    </section>

    <main class="pt-16">
        <div class="mt-6 px-5 md:px-20">
            <h1 class="text-center text-3xl md:text-4xl mt-6 font-bold text-[#0c4c8a]">Elon Team's Blog</h1>
            <div id="mainContainer"></div>
        </div>
    </main>

    <footer class="bg-[#0c4c8a] hover:bg-[#1f3750] py-3">
        <div class="text-white text-center">
            <span>© Blockfuse Labs, The Elon Team, Cohort 2 Web2 Beginners, 2025.</span>
            <p><a href="https://github.com/dgplang/elons-blog-project" target="_blank" class="hover:underline text-white">GitHub Link</a></p>
        </div>
    </footer>

    <script>
        // Capitalize first letters of names
        function capitalizeWords(str) {
            return str.split(' ').map(word => word.charAt(0).toUpperCase() + word.slice(1)).join(' ');
        }

        // Define all categories
        const allCategories = [
            'Technology', 'Health', 'Education', 'Business', 'Lifestyle',
            'Travel', 'Food', 'Entertainment', 'Sports', 'Science',
            'Politics', 'Fashion', 'Art', 'History', 'Philosophy', 'Religion'
        ];

        // Target page for post details
        const targetPage = 'detail.html';

        // Function to fetch all posts across all pages
        function fetchAllPosts(page = 1, accumulatedPosts = []) {
            return fetch(`https://test.blockfuselabs.com/api/posts?page=${page}`, {
                method: 'GET',
                headers: { 'Accept': '*/*' }
            })
            .then(function (response) {
                if (!response.ok) {
                    throw new Error('Failed to fetch posts');
                }
                return response.json();
            })
            .then(function (responseData) {
                const posts = responseData.data || [];
                const allPosts = accumulatedPosts.concat(posts);

                // Check if there's a next page
                if (responseData.next_page_url) {
                    return fetchAllPosts(page + 1, allPosts);
                } else {
                    return allPosts;
                }
            });
        }

        // Function to display blog posts
        function displayElonTeamPosts() {
            const mainContainer = document.getElementById('mainContainer');
            mainContainer.innerHTML = '<p class="text-2xl text-center text-[#1cafce]">Loading posts...</p>';

            // Fetch all posts
            fetchAllPosts()
            .then(function (posts) {
                // Filter posts by team_name "Elon"
                const elonPosts = posts.filter(function (post) {
                    return post.user.team_name === 'Elon';
                });

                if (elonPosts.length === 0) {
                    mainContainer.innerHTML = '<h3 class="text-center text-xl md:text-2xl mt-6 font-bold text-[#1cafce]">No posts found for team Elon.</h3>';
                    return;
                }

                // Group posts by category
                const postsByCategory = {};
                allCategories.forEach(function (category) {
                    postsByCategory[category] = [];
                });

                elonPosts.forEach(function (post) {
                    const categoryName = post.category.name;
                    if (allCategories.includes(categoryName)) {
                        postsByCategory[categoryName].push(post);
                    }
                });

                // Render posts in DOM
                mainContainer.innerHTML = '';

                allCategories.forEach(function (category) {
                    const categoryPosts = postsByCategory[category]; // Remove slice(0, 2) to show all posts
                    if (categoryPosts.length === 0) {
                        return;
                    }

                    const categorySection = document.createElement('div');
                    categorySection.className = 'category-section';

                    const categoryTitle = document.createElement('h3');
                    categoryTitle.className = 'text-center text-xl md:text-2xl mt-6 font-bold text-[#1cafce]';
                    categoryTitle.textContent = category;
                    categorySection.appendChild(categoryTitle);

                    const cardsContainer = document.createElement('div');
                    cardsContainer.className = 'grid grid-cols-1 md:grid-cols-2 gap-8 py-10 max-w-7xl mx-auto';

                    categoryPosts.forEach(function (post) {
                        const cardLink = document.createElement('a');
                        cardLink.href = targetPage + '?id=' + post.id;
                        cardLink.className = 'block no-underline text-inherit relative group hover:scale-105 transition-transform duration-300';

                        const div1 = document.createElement('div');
                        div1.className = 'bg-[#0c4c8a] rounded-xl overflow-hidden shadow-lg group card-container';

                        const ctitle = document.createElement('h2');
                        ctitle.className = 'text-xl md:text-2xl font-bold text-white p-4';
                        ctitle.textContent = post.title;
                        div1.appendChild(ctitle);

                        const div2 = document.createElement('div');
                        div2.className = 'relative';
                        div1.appendChild(div2);

                        const image = document.createElement('img');
                        image.src = post.featured_image_url_full || 'https://via.placeholder.com/300';
                        image.alt = post.slug;
                        image.className = 'w-full h-60 object-cover';
                        div2.appendChild(image);

                        const div3 = document.createElement('div');
                        div3.className = 'absolute inset-0 hidden group-hover:flex items-end justify-center pb-6 gap-4 text-white text-2xl bg-black bg-opacity-40 transition';
                        div3.innerHTML = '<i class="bx bx-heart"></i><i class="bx bx-share"></i><i class="bx bx-bookmark"></i>';
                        div2.appendChild(div3);

                        const div4 = document.createElement('div');
                        div4.className = 'p-4 text-lg text-white';
                        const span1 = document.createElement('span');
                        span1.className = 'block font-semibold';
                        const authorName = post.user.name;
                        span1.textContent = "By " + capitalizeWords(authorName);
                        const span2 = document.createElement('span');
                        span2.className = 'block';
                        span2.textContent = "Category: " + post.category.name;
                        const span3 = document.createElement('span');
                        span3.className = 'block';
                        const formatDate = function (isoDate) {
                            const options = { year: 'numeric', month: 'long', day: 'numeric' };
                            return new Date(isoDate).toLocaleDateString(undefined, options);
                        };
                        span3.textContent = formatDate(post.updated_at);
                        div4.appendChild(span1);
                        div4.appendChild(span2);
                        div4.appendChild(span3);
                        div1.appendChild(div4);

                        cardLink.appendChild(div1);
                        cardsContainer.appendChild(cardLink);
                    });

                    categorySection.appendChild(cardsContainer);
                    mainContainer.appendChild(categorySection);
                });

                if (!mainContainer.hasChildNodes()) {
                    mainContainer.innerHTML = '<h3 class="text-center text-xl md:text-2xl mt-6 font-bold text-[#1cafce]">No posts found for any category.</h3>';
                }
            })
            .catch(function (error) {
                console.error('Error:', error);
                mainContainer.innerHTML = '<p class="text-center text-red-600">Error loading posts: ' + error.message + '</p>';
            });
        }

        // Run the function when the page loads
        document.addEventListener('DOMContentLoaded', displayElonTeamPosts);
    </script>
    <script src="script.js"></script>
</body>
</html>